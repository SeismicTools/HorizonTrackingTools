# FotiadiMath
Программная библиотека для обработки сейсмических и каротажных данных 

Команда для генерации документации: 
0) doxygen можно скачать здесь https://www.doxygen.nl/download.html
1.1) в папке src запустить cmd
1.2) чтобы запускать **из любой директории**, нужно прописать полный путь к папке, куда будут сохраняться выходные файлы. Для этого открываем Doxyfile, находим OUTPUT_DIRECTORY и выставляем путь к папке где будет сгенерирована документация, например: OUTPUT_DIRECTORY       = C:\Users\nikit\Documents\GitHub\FotiadiMath\src\Docs
2.1) "C:\Program Files\doxygen\bin\doxygen.exe" Doxyfile - если **doxygen.exe не добавлен в PATH**
2.2) doxygen Doxyfile - если **doxygen.exe добавлен в PATH**
3.1) после 2.1 В src появится папка Docs\html. В ней открыть файл index.html
3.2) после 2.2 В том месте, где указали в Doxyfile, появится папка html. В ней открыть файл index.html

Сборка
Для сборки по %PATH% должен быть доступен 7z, doxygen, nuget. До сервера linux сборки настроено подключение.

## Гайд по работе с W-SEIS + Desmana + использование плагина для корреляции:

Чтобы собрать dll для Desmana:
1. Запустить "qt-online-installer-windows-x64-4.8.0.exe"
2. Перейти в настройки
3. Выбрать "Manual proxy configuration"
4. Адрес proxy: proxy.quterussia.ru
5. Порт proxy: 31031
6. Жмем ОК
7. Если нет аккаунта, регистрируемся на сайте QT (я указывал свой номер + страну Казахстан + почту с доменом .ru, всё было ок)
8. Заходим под своим аккаунтом
9. Ставил в фильтре галочку на отображение архивных версий библиотеки
10. Обновляем список
11. Находим QT версии 5.15.2 и ставим там галочку
12. Ждем, когда скачается и установится.

Для загрузки базы данных (через UI Desmana):
1. Настройки -> общие параметры
13. Настраиваем"Путь к базе данных" W-SEIS_DEV/bases/3D_DTW.des

Для открытия проекта (через UI Desmana):
1. Нажимаем "Выбрать проект"
2. Выбираем "Ryb_cat"
3. Жмем открыть.

Если проект заблокирован:
1. Заходим в "Проект" -> "Управление данными в БД"
2. Жмем снизу на "Заблокированные проекты..."
3. Выбираем свой проект
4. И нажимаем "Разблокировать"
5. Теперь можно спокойно открывать свой проект.

Открыть плагин в DESMANA для применения корреляции (через UI Desmana):
1. "Инструменты"
2. "Cube inversion..." - второй снизу

После применения плагина (если указали название нового сейсмического куба и проект, куда он сохранится), то:
1) появится новый сейсм. куб во вкладке "Сейсмические кубы";
2) нужно включить его отображение (нажать на глаз возле него);
3) далее на окне отображения жмём ПКМ и выбираем, кросслайн или инлайн.

Удобные ф-ии просмотра инлайнов, кросслайнов:
1) в окне отображения можно нажать пробел, тогда двинемся в сторону по возрастанию индекса;
2) можно нажать Ctrl+пробел, тогда в обратную сторону;
3) слева от значков лупы, можно настроить, сколько измерений мы пройдем в сторону (по умолчанию 10);
4) также там есть стрелочки, можно двигаться не через горячие клавиши, а через них.

В окне интерфейса плагина мы видим Range. Это выбор отражающих горизонтов. Все данные куба между этими горизонтами будет передана в dll плагина (то-бишь мы получаем данные МЕЖДУ границами). 
Также есть возможность сместить поверхность горизонта через интерфейс. Число с -(минусом) - это смещение поверхности вверх (по временной области), а с плюсом - вниз.

Если зайти в "горизонты проекта" (кнопка сверху, слева третья) выбрать горизонт и снизу нажать на "цветовая палитра горизонта", можно настроить палетку отображения высоких, низких областей поверхности.

Если хочется посмотреть отражающие горизонты в 3D представлении:
1) Открываем слева вкладку "сейсмические кубы". Также нужно включить отображение нужного отражающего горизонта (именно для него будет создана сетка)
2) Жмем по нужному кубу правой кнопкой мыши
3) Жмем "сохранить как сетку"
4) После этого появится новая сеточная модель
5) Теперь нажать кнопку сверху справа на экране (под крестиком закрытия приложения)
6) Откроется "HighlightPickedActor". Там можно всё покрутить, посмотреть в 3d
7) По умолчанию она открывается перевернуто. Чтобы было нормально, нужно так направить камеру, чтобы стрелочка была красной стороной вверх.

Для сборки плагина (dll) (exampleInversionPlugin):
1. Мне пришлось в cmake файл добавить 3 строки
- set(CMAKE_PREFIX_PATH C:/Qt/5.15.2/winrt_x64_msvc2019/lib/cmake/Qt5Core)
- set(Qt5Widgets_DIR C:/Qt/5.15.2/winrt_x64_msvc2019/lib/cmake/Qt5Widgets)
- set(Qt5_DIR C:/Qt/5.15.2/winrt_x64_msvc2019/lib/cmake/Qt5)
Прописать свои пути, соответственно.
2. Выставить сборку не Debug, а Release, т.к. Desmana не умеет запускать dll, собранную в debug mode.

Если хочется что-то вывести в логи Desmana (через код в проекте exampleInversionPlugin):
1. qDebug() << "some text"; - в коде dll
2. См. логи здесь: C:\Users\USER\AppData\Local\IPGG\Desmana\Logs

Время жизни объекта-плагина ExampleInversionPlugin:
С момента открытия плагина до момента закрытия Desmana.

Если есть какие-то другие вопросы (через UI Desmana):
1. "Справка" -> "Руководство пользователя"

## Структура проекта

1. cSharpRunExampleProject - содержит C# код nuget обертки и примеры использования
2. exampleInversionPluginNew - содержит код реализованного на cpp плагина для W-SEIS, Desmana
3. pythonProject - содержит python код для отображения данных (корреляционный планшет, остовное дерево, отображение сигналов через DTW)
4. src - код dll FotiadiMath на cpp.